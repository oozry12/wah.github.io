<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">












  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.2.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon.ico?v=7.2.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon.ico?v=7.2.0">


  <link rel="mask-icon" href="/images/logo.svg?v=7.2.0" color="#222">






<link rel="stylesheet" href="/css/main.css?v=7.2.0">

<link href="https://fonts.proxy.ustclug.org/css?family=Noto+Serif+SC:400,500&display=swap" rel="stylesheet">
<link href="https://fonts.proxy.ustclug.org/css?family=EB+Garamond:400,400i,700,700i&display=swap" rel="stylesheet">




<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">




  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link rel="stylesheet" href="/lib/pace/pace-theme-material.min.css?v=1.0.2">



  
  
  <link rel="stylesheet" href="/lib/fancybox/source/jquery.fancybox.css">



<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.2.0',
    sidebar: {"position":"left","Pisces | Gemini":240,"display":"post","offset":12,"onmobile":false},
    back2top: {"enable":true,"sidebar":true,"scrollpercent":true},
    copycode: {"enable":false,"show_result":false,"style":null},
    fancybox: true,
    mediumzoom: true,
    lazyload: true,
    pangu: true,
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    search: {
      root: '/',
      path: 'search.xml'
    },
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'å¤åˆ¶',
      copy_success: 'å¤åˆ¶æˆåŠŸ',
      copy_failure: 'å¤åˆ¶å¤±è´¥'
    }
  };
</script>

  <meta name="description" content="æ®è¯´æœ€æ–°xposedæ”¯æŒAndroid 7.xç³»ç»Ÿï¼Œå¤§å®¶ä¸€ç‰‡æ¬¢å‘¼ï¼Œç­‰å¾—ä¸è¦å¤ªä¹…ã€‚ç®€ç›´é¥¥æ¸´å•Šã€‚é«˜å…´æ˜¯é«˜å…´ï¼Œå’±è¿˜è¦ç†æ€§çœ‹å¾…ã€‚ä½†æ˜¯ï¼Œè¯·å¤§å®¶æ³¨æ„æ…é‡è€ƒè™‘ï¼ŒåŸå› å¦‚ä¸‹ï¼š 1ã€å¼€å‘è€…å¹¶éxposedçš„åŸåˆ›rovo89å¤§ç¥ï¼Œç›®å‰æ‰€æœ‰çš„é¡¹ç›®éƒ½æ˜¯åŸºäºabforceè¿™ä½å¼€å‘è€… 2ã€xposedæ¡†æ¶åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œæ˜¯ç³»ç»Ÿå±‚çº§çš„ä¿®æ”¹ï¼Œä»£ç è´¨é‡ä¸ç»´æŠ¤æ°´å¹³å½±å“åˆ°æ•´ä¸ªæ‰‹æœºç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œå¯èƒ½éšæ—¶å´©æºƒ 3ã€Androidç”Ÿæ€åœˆæ¯”è¾ƒå¼€æ”¾">
<meta name="keywords" content="tech,xposed">
<meta property="og:type" content="article">
<meta property="og:title" content="Xposed for Android N">
<meta property="og:url" content="https://o.oozry.com/xposed-for-n.html">
<meta property="og:site_name" content="è¯ğŸ’•æ•">
<meta property="og:description" content="æ®è¯´æœ€æ–°xposedæ”¯æŒAndroid 7.xç³»ç»Ÿï¼Œå¤§å®¶ä¸€ç‰‡æ¬¢å‘¼ï¼Œç­‰å¾—ä¸è¦å¤ªä¹…ã€‚ç®€ç›´é¥¥æ¸´å•Šã€‚é«˜å…´æ˜¯é«˜å…´ï¼Œå’±è¿˜è¦ç†æ€§çœ‹å¾…ã€‚ä½†æ˜¯ï¼Œè¯·å¤§å®¶æ³¨æ„æ…é‡è€ƒè™‘ï¼ŒåŸå› å¦‚ä¸‹ï¼š 1ã€å¼€å‘è€…å¹¶éxposedçš„åŸåˆ›rovo89å¤§ç¥ï¼Œç›®å‰æ‰€æœ‰çš„é¡¹ç›®éƒ½æ˜¯åŸºäºabforceè¿™ä½å¼€å‘è€… 2ã€xposedæ¡†æ¶åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œæ˜¯ç³»ç»Ÿå±‚çº§çš„ä¿®æ”¹ï¼Œä»£ç è´¨é‡ä¸ç»´æŠ¤æ°´å¹³å½±å“åˆ°æ•´ä¸ªæ‰‹æœºç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œå¯èƒ½éšæ—¶å´©æºƒ 3ã€Androidç”Ÿæ€åœˆæ¯”è¾ƒå¼€æ”¾">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2018-05-02T12:31:05.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Xposed for Android N">
<meta name="twitter:description" content="æ®è¯´æœ€æ–°xposedæ”¯æŒAndroid 7.xç³»ç»Ÿï¼Œå¤§å®¶ä¸€ç‰‡æ¬¢å‘¼ï¼Œç­‰å¾—ä¸è¦å¤ªä¹…ã€‚ç®€ç›´é¥¥æ¸´å•Šã€‚é«˜å…´æ˜¯é«˜å…´ï¼Œå’±è¿˜è¦ç†æ€§çœ‹å¾…ã€‚ä½†æ˜¯ï¼Œè¯·å¤§å®¶æ³¨æ„æ…é‡è€ƒè™‘ï¼ŒåŸå› å¦‚ä¸‹ï¼š 1ã€å¼€å‘è€…å¹¶éxposedçš„åŸåˆ›rovo89å¤§ç¥ï¼Œç›®å‰æ‰€æœ‰çš„é¡¹ç›®éƒ½æ˜¯åŸºäºabforceè¿™ä½å¼€å‘è€… 2ã€xposedæ¡†æ¶åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œæ˜¯ç³»ç»Ÿå±‚çº§çš„ä¿®æ”¹ï¼Œä»£ç è´¨é‡ä¸ç»´æŠ¤æ°´å¹³å½±å“åˆ°æ•´ä¸ªæ‰‹æœºç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œå¯èƒ½éšæ—¶å´©æºƒ 3ã€Androidç”Ÿæ€åœˆæ¯”è¾ƒå¼€æ”¾">





  
  
  <link rel="canonical" href="https://o.oozry.com/xposed-for-n">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  
  <title>Xposed for Android N | è¯ğŸ’•æ•</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta custom-logo">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">è¯ğŸ’•æ•</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">ç´›ç¹è¬åƒ åªæƒ³æ”œæ‰‹ä¸€ç”Ÿ</p>
      
    
    
      <a>
        <img class="custom-logo-image" src="/img/logo.png" alt="è¯ğŸ’•æ•">
      </a>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>é¦–é¡µ</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>æ ‡ç­¾</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-books">

    
    
      
    

    

    <a href="/books/" rel="section"><i class="menu-item-icon fa fa-fw fa-book"></i> <br>ä¹¦ç±</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-movies">

    
    
      
    

    

    <a href="/movies/" rel="section"><i class="menu-item-icon fa fa-fw fa-video-camera"></i> <br>ç”µå½±</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>å½’æ¡£</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          <a href="javascript:;" class="popup-trigger">
          
            <i class="menu-item-icon fa fa-search fa-fw"></i> <br>æœç´¢</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="æœç´¢..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
      

  
  
  

  
    <div class="reading-progress-bar"></div>
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://o.oozry.com/xposed-for-n.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wah & min">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è¯ğŸ’•æ•">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Xposed for Android N

              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2017-07-21 20:26:25" itemprop="dateCreated datePublished" datetime="2017-07-21T20:26:25+08:00">2017-07-21</time>
            </span>
          

          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">æ›´æ–°äº</span>
                
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2018-05-02 20:31:05" itemprop="dateModified" datetime="2018-05-02T20:31:05+08:00">2018-05-02</time>
              </span>
            
          

          

          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
                 é˜…è¯»æ¬¡æ•°ï¼š 
                <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
              </span>
            </span>
          

          

          <br>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>æ®è¯´æœ€æ–°xposedæ”¯æŒAndroid 7.xç³»ç»Ÿï¼Œå¤§å®¶ä¸€ç‰‡æ¬¢å‘¼ï¼Œç­‰å¾—ä¸è¦å¤ªä¹…ã€‚ç®€ç›´é¥¥æ¸´å•Šã€‚é«˜å…´æ˜¯é«˜å…´ï¼Œå’±è¿˜è¦ç†æ€§çœ‹å¾…ã€‚<br>ä½†æ˜¯ï¼Œè¯·å¤§å®¶æ³¨æ„æ…é‡è€ƒè™‘ï¼ŒåŸå› å¦‚ä¸‹ï¼š</p>
<p>1ã€å¼€å‘è€…å¹¶éxposedçš„åŸåˆ›rovo89å¤§ç¥ï¼Œç›®å‰æ‰€æœ‰çš„é¡¹ç›®éƒ½æ˜¯åŸºäºabforceè¿™ä½å¼€å‘è€…</p>
<p>2ã€xposedæ¡†æ¶åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œæ˜¯ç³»ç»Ÿå±‚çº§çš„ä¿®æ”¹ï¼Œä»£ç è´¨é‡ä¸ç»´æŠ¤æ°´å¹³å½±å“åˆ°æ•´ä¸ªæ‰‹æœºç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œå¯èƒ½éšæ—¶å´©æºƒ</p>
<p>3ã€Androidç”Ÿæ€åœˆæ¯”è¾ƒå¼€æ”¾è‡ªç”±ï¼Œé±¼é¾™æ··æ‚ï¼Œåœ¨æ‰€è°“çš„åˆ·æœºåŒ…å†…å¯èƒ½åµŒå…¥æ¶æ„ä»£ç ï¼Œæ¶æ„æ‰£è´¹æ¨å¹¿ä¹‹ç±»</p>
<p>4ã€åŸåˆ›ä½œè€…æ—©å°±å®Œæˆè¿™ä¸€æ­¥éª¤ï¼Œä½†å¾ˆå¿«æŠ›å¼ƒè¿™ä¸€æƒ³æ³•ï¼Œæ­£åœ¨æé«˜æ¡†æ¶ç¨³å®šæ€§ã€‚ç›®å‰å¾ˆå¤šæ¨¡å—æ²¡æ›´æ–°ï¼Œæ¡†æ¶æœ‰äº†æ²¡æ¨¡å—ç”¨</p>
<a id="more"></a>
<p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-ï¼ˆåˆ†å‰²çº¿ ä¸‹é¢æ˜¯è¿™ä¸ªé¡¹ç›®çš„ä¸€äº›æ¥é¾™å»è„‰ï¼‰â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-</p>
<blockquote>
<p><strong>ç¼˜èµ·</strong></p>
</blockquote>
<p>å¼€å‘è€…abforceæ„Ÿè§‰å¾ˆä¹…æ²¡æ¡†æ¶ç”¨ï¼Œåœ¨githubç»™rovo89å¤§ç¥å‘issuesè¦ä»–å¸®å¿™å†™å¼€å‘æ–‡æ¡£ï¼Œç»™åŒ…æ‹¬ä»–åœ¨å†…çš„æœ‰æ—¶é—´çš„å¼€å‘è€…å¼€å‘xposed_art_nã€‚<br>è€Œrovo89æ®è¯´åœ¨æ¬å®¶æ²¡å¤ªå¤šç©ºå¼€å‘ã€‚å¼€å‘è€…abforceä¹‹åç›´æ¥å˜²ç¬‘ä»–ï¼Œæ˜¯ä¸æ˜¯ç©å…¶ä»–å°ä¸œè¥¿å»äº†æ²¡æ—¶é—´äº†ã€‚<br>åŸè¯</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">What do you think? Do you have time for this or would prefer to still enjoy your life (and possibly playing with your puppies)?</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>å†æ¬¡é‚‚é€…</strong></p>
</blockquote>
<p>åé¢ â€˜abforceâ€™ å›å¼ºç¡¬é­”æ”¹äº†å¾ˆå¤šä»£ç ï¼Œå†é›†æˆåˆ°ç³»ç»Ÿå†…ï¼Œç„¶åè¦æ±‚ â€˜rovo89â€™ å¸®å¿™reviewä»£ç ï¼Œå¹¶ä¸”diffå‡ºä¸åŒé¡¹ç›®çš„åŒºåˆ«ã€‚<br>rovo89å›åº”é“ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The actual implementation is the smallest part of developing Xposed. Getting the knowledge about how the ART compiler and runtime works and finding ways to integrate Xposed with maximum compatiblity is the most time-consuming and complex part. Books could be written about the small, yet very important details that have to be considered. Sometimes when I understood how a particular implementation works and which tricks they&apos;re using, I indeed think I should write something up about it, but that would take me even more time (which I currently don&apos;t have).</span><br></pre></td></tr></table></figure>

<p>ï¼ˆå¤§æ¦‚æ„æ€æ˜¯æ–°ç‰ˆæœ¬çš„ARTæœºåˆ¶å¾ˆå¤æ‚ï¼Œä»–æ­£åœ¨ç ”ç©¶ç ´è¯‘å†…éƒ¨æŠ€å·§ï¼Œè€Œå¯¹äºå…¼å®¹æ€§çš„æ¢ç´¢æ˜¯æœ€è€—æ—¶é—´ä¹Ÿæ˜¯æœ€éš¾çš„éƒ¨åˆ†ï¼Œä»–åœ¨è®°å½•ä¸€äº›ï¼Œä½†ä¸å¯èƒ½æŠ½å‡ºå¤§ç‰‡ç©ºç™½æ—¶é—´å†™è¿™ä¹ˆå®å¤§çš„å¼€å‘æ–‡æ¡£ï¼‰</p>
<blockquote>
<p><strong>å†åº¦å›åº”</strong>ï¼š</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Congrats ;) Unfortunately, I can&apos;t review your changes, it&apos;s just too much and I don&apos;t remember all those details where I deviated from simply porting the Marshmallow changes and which additional changes were required to make it reliable (i.e. to ensure that the hooks are called even with compiler optimizations).</span><br><span class="line"></span><br><span class="line">As you already mentioned, your changes could only work for ROMs compiled from scratch with Xposed already active, so people should understand that this won&apos;t work (at least not reliably) on their stock or otherwise pre-compiled ROMs.</span><br></pre></td></tr></table></figure>

<p>ï¼ˆå¤§æ¦‚æ„æ€æ˜¯ æ­å–œï¼Œå‘µå‘µã€‚æˆ‘ä¸å¯èƒ½èƒ½çŸ­æ—¶é—´å†…reviewä½ çš„ä¿®æ”¹éƒ¨åˆ†ï¼Œå¾ˆéš¾å›å¿†èµ·æ¥å¤§é‡çš„ä»…ä»…åªæ˜¯ä»Mç‰ˆæœ¬ç§»æ¤åˆ°Nç‰ˆæœ¬ç»†èŠ‚ï¼Œè¿™äº›ä¿®æ”¹èƒ½å¦ä¿è¯åœ¨ç¼–è¯‘å™¨ä¼˜åŒ–åä»ç„¶èƒ½æ­£å¸¸ä½¿ç”¨ä»ç„¶æ˜¯ä¸ç¡®å®šçš„ã€‚æ­£å¦‚ä½ æåˆ°çš„ï¼Œä½ åˆ©ç”¨é›†æˆå…¥ç³»ç»Ÿçš„æ¡†æ¶ï¼Œé‚£ä¹ˆå°±ç®—ç”¨æˆ·ç†è§£ä¸ºç”¨å¤„ä¸å¤§ï¼Œæˆ–è€…è¯´ä¸é è°±ã€‚å› ä¸ºå¤ªå¤šç”¨æˆ·è¿˜åœ¨å®˜æ–¹ç³»ç»Ÿè€Œä¸æ˜¯é¢„ç¼–è¯‘å¥½çš„ROMï¼‰</p>
<blockquote>
<p><strong>å†æ¬¡äº¤é”‹</strong></p>
</blockquote>
<p>abforceå›å†æ¬¡æ„Ÿè°¢å¤§ç¥çš„å›å¤ã€‚åœ¨å‘ç°å¾ˆå¤šçš„å´©æºƒå’Œä¸æ­£å¸¸è¿è¡Œçš„é—®é¢˜åï¼Œå†æ¬¡è¦æ±‚rovo89å›reviewä»£ç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">But there&apos;s a problem when GC runs, specifically I suspect that heap or stack will be malformed when XPrivacy is enabled.</span><br><span class="line"></span><br><span class="line">As I traced down the error, the problem seems to be related to visiting roots when GC marks objects. Moving form M to N, just one of your commits I couldn&apos;t port directly, that of ArtMethod::VisitRoots.</span><br><span class="line"></span><br><span class="line">Also enabling hook resources causes the problem when GC runs, are you sure your modified Object.Clone() doesn&apos;t cause memory issues?</span><br></pre></td></tr></table></figure>

<p>ï¼ˆå¤§æ¦‚æ„æ€æ˜¯æœ‰äº›æ¨¡å—å¦‚XPrivacy æŠ¥é”™ï¼Œä»–æä¸æ‡‚ä¸€äº›é—®é¢˜ï¼‰</p>
<blockquote>
<p><strong>é«˜æ½®</strong></p>
</blockquote>
<p>å¼€æºæ‰‹æœºç•Œç¬é—´ç‚¸å¼€äº†é”…ã€‚å¾ˆå¤šå¼€å‘è€…ç®€å•åœ°åˆ©ç”¨abforceå›çš„ç®€å•æ•™ç¨‹ï¼Œé›†æˆç¼–è¯‘äº†å¾ˆå¤šromsï¼Œä½†å…¨éƒ¨éƒ½æ˜¯åŸºäºä»–çš„ä»£ç ï¼Œå¤§éƒ¨åˆ†ä¹Ÿå¯ä»¥å¼€æœºï¼Œå¹¶ä¸”æœ‰äº›æ¨¡å—çœ‹ä¼¼æ­£å¸¸è¿è¡Œã€‚</p>
<blockquote>
<p><strong>å†æ¬¡æ¾„æ¸…è¡¨æ€</strong></p>
</blockquote>
<p>ä»Šå¤©5å°æ—¶å‰</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Surprisingly by porting M changes to N everything works well,</span><br><span class="line">From my experience, I can tell you that it&apos;s indeed not that hard to get the basics done, but it takes a hell lot of time for the details. It&apos;s like the 80-20 rule, except that it&apos;s more like 95-5 or so.</span><br><span class="line"></span><br><span class="line">The hooking approach I have designed for the previous releases is rather stable and can be applied for newer releases as well. I assume you needed most of the time to check all the places where IsProxyMethod() and IsDirect() is called and decide whether they should consider the new method modifier or not (i.e. use parameter true or not). If you didn&apos;t do that, you might have missed some places where they have newly introduced such calls. Same for methods like InstallStubsForMethod(), which needs to operate on the original original method even when they&apos;re called for a hooked method. You&apos;d need to check for more places where this could be relevant. That&apos;s still in the range of days, but if you miss to do it, you might see obscure crashes or misbehavior that are very hard to debug.</span><br><span class="line"></span><br><span class="line">Besides that, you took an approach where hooks would only work properly for ROMs which are entirely compiled from scratch. On stock ROMs and even most custom ROMs (that didn&apos;t include your port while building) as well as for any apps the device might have compiled before. So you&apos;d have to start all over again with a wiped device running a special ROM. If not, then optimizations (e.g. inlining) might prevent a method from being called at all, and hence hooks wouldn&apos;t work. The worst thing about this is that the exact behavior would depend on the ROM, or even how the user uses the device (now that apps are compiled based on profiles). Modules would fail randomly and the module developers would be wondering what they did wrong (answer: nothing). If not all of the prerequisites are fulfilled, it&apos;s a pretty unreliable API. Imagine Google published an update where the OnClickListener of a button wasn&apos;t called sometimes, unless you compiled your ROM from scratch... For me personally, this is a big limitation.</span><br><span class="line"></span><br><span class="line">There is a flashable xposed for N available here:</span><br><span class="line">https://forum.xda-developers.com/xposed/unofficial-xposed-v87-unofficial-yes-im-t3639192</span><br><span class="line">It seems like it&apos;s for AOSP ROMs</span><br><span class="line">Their code is @abforce&apos;s port, with all the limitations I listed above. :roll_eyes: It doesn&apos;t make sense at all to publish flashable ZIPs with this, as the port is only intended for recompiling a ROM from scratch.</span><br><span class="line">And as I feared, there is not a single warning that this is an incomplete port that will often fail to fulfill the API contract. :angry: That&apos;s bad for developers and users, they should at least know it&apos;s incomplete so they can decide whether they want to support/use it. I would never dare to do something like that without a big fat warning. Actually, as I&apos;m rather perfectionist, I wouldn&apos;t publish an incomplete version at all, reliablity is very important for me.</span><br><span class="line"></span><br><span class="line">I just checked my Git log and I had the basic hooking (as in this port) ready in October. Since then, I have worked on removing the limitations. To make it more reliable on pre-compiled ROMs, I could have ported the recompiling part as well, however that&apos;s still not ideal. As explained somewhere above, we have JIT now, which allows us to keep all the optimizations, only invalidating (and possibly recompiling) the methods which are directly affected by hooking. This is quite challenging, as it&apos;s more than just copy &amp; paste. And until this isn&apos;t done, I won&apos;t publish anything. 9 months for that (until now) is really a long time, I know, but hey, it&apos;s my spare time and e.g. due to moving to a new apartment, I couldn&apos;t work on Xposed for several months (!) at all, and had only very limited time otherwise.</span><br><span class="line"></span><br><span class="line">As I traced down the error, the problem seems to be related to visiting roots when GC marks objects.</span><br><span class="line">Also enabling hook resources causes the problem when GC runs, are you sure your modified Object.Clone() doesn&apos;t cause memory issues?</span><br><span class="line">I just commented on your diff. There&apos;s no real difference in my code for these two methods, so you&apos;ll have to debug it yourself. I know this can be hard, as the real culprit can sometimes be in a totally different place. Even if it ends up to be a single character that needs to be changed, you can easily spend dozens of hours on debugging one issue. That said - if you&apos;re seriously interested in contributing, this might be a good challenge. :wink:</span><br></pre></td></tr></table></figure>

<p>ï¼ˆå¤§æ¦‚æ„æ€æ˜¯åŸºç¡€éƒ¨åˆ†ï¼Œç§»æ¤è¿‡å»ä¸éš¾ï¼Œä½†æ˜¯æ­£å¦‚è‘—åçš„äºŒå…«å®šå¾‹ï¼Œåé¢æ›´è€—æ—¶é—´æ›´å›°éš¾ã€‚æˆ‘ä¹‹å‰çš„ä»£ç è®¾è®¡éƒ½å¯ä»¥æ²¿ç”¨åˆ°æ–°ç‰ˆæœ¬ï¼Œå¦‚æœåªå…³æ³¨å±€éƒ¨ï¼ŒåæœŸä½ å°†å¾ˆéš¾debugæ’æŸ¥æ•´ä¸ªé¡¹ç›®çš„bugã€‚åŸºäºå¿…é¡»é›†æˆå…¥ROMï¼Œå¦‚æœé‡åˆ°å¥‡æ€ªçš„è®¾å¤‡æˆ–è€…ç³»ç»Ÿï¼Œä½ å°†è¦ä»å¤´ç¼–è¯‘æ’æŸ¥ã€‚å› ä¸ºè¿™ç§ä¸å…¼å®¹æ€§ï¼Œå¾ˆå¤šæ¨¡å—ä¼šéšæœºæ€§åœ°å‡ºé”™ã€‚å¯¹äºå®Œç¾ä¸»ä¹‰è€…çš„æˆ‘ï¼Œæˆ‘ç»å¯¹ä¸ä¼šå‘å¸ƒä»»ä½•æ²¡å®Œæˆçš„æœ‰å·¨å¤§é£é™©çš„é¡¹ç›®ä»£ç ï¼Œå¯é æ€§æ˜¯æˆ‘çš„ç¬¬ä¸€æ ‡å‡†ã€‚å›é¡¾æˆ‘çš„ä»£ç æäº¤è®°å½•ï¼Œæ—©åœ¨å»å¹´10æœˆæˆ‘éƒ½å®Œæˆè¿™éƒ¨åˆ†å·¥ä½œï¼Œè‡ªä»é‚£ä»¥åï¼Œæˆ‘ä¸€ç›´è‡´åŠ›äºç ”ç©¶å¯é æ€§ä¸å…¼å®¹æ€§ã€‚åœ¨æˆ‘ä¸ªäººæ—¶é—´é‡Œï¼Œæˆ‘æ¬å®¶èŠ±è´¹äº†ä¸å°‘ï¼Œä½†æˆ‘è¿˜æ˜¯æŠ•å…¥å¼€å‘ç ”ç©¶ã€‚æˆ‘å·²ç»æ£€æŸ¥äº†ä½ çš„ä¿®æ”¹ï¼Œå¹¶æ²¡æœ‰å¤ªå¤šçš„æ–°çš„ä¸œè¥¿ï¼Œæ‰€ä»¥ä½ éœ€è¦è‡ªå·±æ’æŸ¥ã€‚æœ€åç¥ä½ è¿æ¥æŒ‘æˆ˜ï¼Œå¥½å¥½åŠ æ²¹ï¼‰</p>
<blockquote>
<p><strong>æœ€åå¿ å‘Š</strong></p>
</blockquote>
<p>rovo89è¯´é“ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">And just to add to my reply above: Imagine I published my current WIP now. I bet that some people would publish it as their build, without any warnings that it&apos;s incomplete and not intended to be used productively.</span><br></pre></td></tr></table></figure>

<p>ï¼ˆå¤§æ¦‚æ„æ€æ˜¯å¸Œæœ›å¤§å®¶é™„ä¸Šæˆ‘çš„å¿ å‘Šï¼Œè¿™äº›ä¸å®Œæ•´çš„ä¿®æ”¹ä¸åº”è¯¥ç”¨åœ¨ç”Ÿäº§ç¯å¢ƒï¼‰</p>
<p>ä»¥ä¸ŠåŸæ–‡å…¨éƒ¨åœ¨githubä¸­ã€‚é…·å®‰ï¼Œå’Œå¾®åšä¹Ÿæœ‰ å„è·¯å¤§ç¥ï¼ˆåŒ…æ‹¬å´å¤§ï¼‰çš„çœ‹æ³•ä¸è¯´æ˜ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">github.com/rovo89/Xposed/issues/230</span><br><span class="line">abforceçš„ä»£ç é¡¹ç›® github.com/abforce/xposed_art_n</span><br></pre></td></tr></table></figure>

<p>å…¨ç¨‹æ‰‹æ‰“ã€‚ç†æ€§åˆ†æã€‚å¤§ç¥è½»è½»æ‹ã€‚</p>
<p><img alt="1" data-src="http://static.oneplus.cn/data/attachment/forum/201707/20/204103fr0v07a3sx08et74.png.w_768.png"><br><img alt="2" data-src="http://static.oneplus.cn/data/attachment/forum/201707/20/204103v0htzvhxughxvthh.png.w_768.png"></p>

      
    </div>

    

    
      
    

    
    
    

    

    
      
    
    
      <div>
        <div id="reward-container">
  <div>å‘å¤§ä½¬ä½å¤´~</div>
  <button id="reward-button" disable="enable" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    æ‰“èµ
  </button>
  <div id="qr" style="display: none;">

    
      
      
        
      
      <div style="display: inline-block">
        <img src="/images/wechat.png" alt="wah & min å¾®ä¿¡æ”¯ä»˜">
        <p>å¾®ä¿¡æ”¯ä»˜</p>
      </div>
    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        
          
        
        <div class="post-tags">
          
            <a href="/tags/tech/" rel="tag"><i class="fa fa-tag"></i> tech</a>
          
            <a href="/tags/xposed/" rel="tag"><i class="fa fa-tag"></i> xposed</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/music-fruit.html" rel="prev" title="æ¸©æŸ”è€Œåšå®šçš„å£°éŸ³">
                æ¸©æŸ”è€Œåšå®šçš„å£°éŸ³ <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>

  </div>


          </div>
          
  
    
    
  <div class="comments" id="comments">
    <div id="lv-container" data-id="city" data-uid="MTAyMC80NTY0OC8yMjE1OQ=="></div>
  </div>
  
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">

          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  
  <p class="site-author-name" itemprop="name">wah & min</p>
  <div class="site-description motion-element" itemprop="description"></div>
</div>


  <nav class="site-state motion-element">
    
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">12</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
    

    
      
      
      <div class="site-state-item site-state-categories">
        
        
        
          
        
          
        
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">åˆ†ç±»</span>
        
      </div>
    

    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/tags/">
          
        
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">æ ‡ç­¾</span>
        </a>
      </div>
    
  </nav>







  <div class="links-of-author motion-element">
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="https://weibo.com/id110" title="Weibo &rarr; https://weibo.com/id110" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i>Weibo</a>
      </span>
    
  </div>







          
          
        </div>
      </div>

      

      
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2012 â€“ <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">wah & min</span>

  

  
</div>


  <div class="powered-by">ç”± <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> å¼ºåŠ›é©±åŠ¨</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">ä¸»é¢˜ â€“ <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a></div>




        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="post-meta-item-icon">
      <i class="fa fa-user"></i>
    </span>
    <span class="site-uv" title="æ€»è®¿å®¢é‡">
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="post-meta-divider">|</span>
  

  
    <span class="post-meta-item-icon">
      <i class="fa fa-eye"></i>
    </span>
    <span class="site-pv" title="æ€»è®¿é—®é‡">
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    

    

    

    

  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>






  



  



  



  



  



  
  



  
    
    
  
  <script color="0,0,255" opacity="0.4" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script>







  
  <script src="/lib/jquery/index.js?v=3.4.1"></script>

  
  <script src="/lib/fancybox/source/jquery.fancybox.pack.js"></script>

  
  <script src="/lib/mediumzoom/medium-zoom.min.js"></script>

  
  <script src="/lib/lazyload/lozad.min.js?v=1.10.0"></script>

  
  <script src="/lib/pangu/dist/pangu.min.js?v=4.0.7"></script>

  
  <script src="/lib/reading_progress/reading_progress.js"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>




  <script src="/js/utils.js?v=7.2.0"></script>

  <script src="/js/motion.js?v=7.2.0"></script>



  
  


  <script src="/js/affix.js?v=7.2.0"></script>

  <script src="/js/schemes/pisces.js?v=7.2.0"></script>




  
  <script src="/js/scrollspy.js?v=7.2.0"></script>
<script src="/js/post-details.js?v=7.2.0"></script>



  <script src="/js/next-boot.js?v=7.2.0"></script>

  
  <script src="/js/js.cookie.js?v=7.2.0"></script>
  <script src="/js/scroll-cookie.js?v=7.2.0"></script>


  

  


  













  <script src="/js/local-search.js?v=7.2.0"></script>












<script>
// GET RESPONSIVE HEIGHT PASSED FROM IFRAME

window.addEventListener("message", function(e) {
  var data = e.data;
  if ((typeof data === 'string') && (data.indexOf('ciu_embed') > -1)) {
    var featureID = data.split(':')[1];
    var height = data.split(':')[2];
    $(`iframe[data-feature=${featureID}]`).height(parseInt(height) + 30);
  }
}, false);
</script>








  
    



<script>
  window.livereOptions = {
    refer: 'xposed-for-n.html'
  };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
</script>


  

</body>
</html>
